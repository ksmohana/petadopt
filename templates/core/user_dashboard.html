{% extends "base.html" %}

{% block title %}My Dashboard - {{ block.super }}{% endblock title %}

{% block content %}
<h1 class="text-center mb-4">My Dashboard</h1>

<h2 class="mb-3">My Reported Pets</h2>

<div class="row">
    {% if requests %}
    {% for req in requests %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card shadow-sm h-100">
            {% if req.pet.image %}
            <img src="{{ req.pet.image.url }}" class="card-img-top" alt="{{ req.pet.pet_name }}"
                style="height: 250px; object-fit: cover;">
            {% else %}
            <img src="https://via.placeholder.com/400x250.png?text=No+Photo" class="card-img-top" alt="No Photo">
            {% endif %}

            <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ req.pet.pet_name|default:"Unnamed" }} ({{ req.pet.pet_type }})</h5>

                <p class="card-text">
                    <strong>Report Type:</strong> {{ req.request_type }}<br>
                    <strong>Status:</strong>
                    {% if req.status == 'Pending' %}
                    <span class="badge bg-warning text-dark">{{ req.status }}</span>
                    {% elif req.status == 'Approved' %}
                    <span class="badge bg-success">{{ req.status }}</span>
                    {% else %}
                    <span class="badge bg-secondary">{{ req.status }}</span>
                    {% endif %}
                    <br>
                    <strong>Reported On:</strong> {{ req.date_requested|date:"M d, Y" }}
                </p>

                {% if req.status == 'Pending' %}
                <div class="mt-auto d-flex justify-content-end">
                    <a href="{% url 'core:edit_request' req.pet.id %}"
                        class="btn btn-outline-primary btn-sm me-2">Edit</a>
                    <a href="{% url 'core:delete_request' req.pet.id %}"
                        class="btn btn-outline-danger btn-sm">Delete</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="col">
        <div class="alert alert-info" role="alert">
            You have not reported any pets yet.
        </div>
    </div>
    {% endif %}
</div>

{% endblock content %}